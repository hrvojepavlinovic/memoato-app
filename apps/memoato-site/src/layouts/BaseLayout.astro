---
type Props = {
  title: string;
  description?: string;
  canonicalPath?: string;
};

import "../styles/global.css";

const { title, description, canonicalPath } = Astro.props;
const databuddyClientId =
  import.meta.env.PUBLIC_DATABUDDY_CLIENT_ID?.trim() || "c1678578-eedf-4cbc-bbc6-8dfa541712dc";

const canonical = canonicalPath
  ? new URL(canonicalPath, Astro.site ?? "https://memoato.com").toString()
  : undefined;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{title}</title>
    {description ? <meta name="description" content={description} /> : null}
    {canonical ? <link rel="canonical" href={canonical} /> : null}

    <link rel="icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

    <meta name="theme-color" content="#ffffff" />
    <meta property="og:site_name" content="memoato" />
    <meta property="og:title" content={title} />
    {description ? <meta property="og:description" content={description} /> : null}
    {canonical ? <meta property="og:url" content={canonical} /> : null}

  </head>
  <body>
    <header class="topbar">
      <div class="topbar-inner">
        <a class="brand" href="/">
          <span class="logo">
            <img src="/logo.png" alt="memoato" width="18" height="18" />
          </span>
          <span>memoato</span>
        </a>
        <div class="header-actions">
          <nav class="navlinks">
            <a class="btn sm" href="/about">About</a>
            <a class="btn sm" href="/help">Help</a>
            <a class="btn sm" href="/blog">Blog</a>
            <a class="btn sm" href="/privacy">Privacy</a>
          </nav>
          <a
            class="icon-btn"
            href="https://github.com/hrvojepavlinovic/memoato-app"
            rel="noopener noreferrer"
            aria-label="GitHub"
            title="GitHub"
            target="_blank"
          >
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
              <path
                d="M12 .5a12 12 0 0 0-3.8 23.4c.6.1.8-.2.8-.5v-2c-3.3.7-4-1.4-4-1.4-.6-1.5-1.4-1.9-1.4-1.9-1.2-.8.1-.8.1-.8 1.3.1 2 .1 2.8 1.9 1.1 1.9 2.9 1.4 3.6 1.1.1-.8.4-1.4.7-1.7-2.7-.3-5.4-1.4-5.4-6.1 0-1.3.5-2.4 1.2-3.2-.1-.3-.5-1.6.1-3.3 0 0 1-.3 3.3 1.2a11.4 11.4 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.7.2 3 .1 3.3.8.8 1.2 1.9 1.2 3.2 0 4.7-2.7 5.8-5.4 6.1.4.3.8 1.1.8 2.2v3.3c0 .3.2.6.8.5A12 12 0 0 0 12 .5Z"
              />
            </svg>
          </a>
          <a class="btn primary" href="https://app.memoato.com" rel="noreferrer" referrerpolicy="no-referrer">
            Open app
          </a>
        </div>
      </div>
    </header>

    <main>
      <slot />
    </main>

    <footer class="footer">
      <div class="container footer-grid">
        <div>
          <a class="brand" href="/">
            <span class="logo">
              <img src="/logo.png" alt="memoato" width="18" height="18" />
            </span>
            <span>memoato</span>
          </a>
          <div style="margin-top: 0.75rem">
            Minimal habit tracking for ADHD brains: fast input, clear progress, fewer decisions.
          </div>
          <div style="margin-top: 1rem; display: flex; gap: 0.75rem; flex-wrap: wrap; align-items: center">
            <a class="btn primary sm" href="https://app.memoato.com" rel="noreferrer" referrerpolicy="no-referrer">
              Open app
            </a>
            <a
              class="icon-btn"
              href="https://x.com/0xhp10"
              rel="noopener noreferrer"
              aria-label="X"
              title="X"
              target="_blank"
            >
              <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path
                  d="M18.9 2H22l-6.8 7.8L23.2 22h-6.4l-5-6.5L6 22H2.8l7.3-8.4L1 2h6.6l4.6 6 6.7-6Zm-1.1 18h1.8L7.5 3.9H5.6L17.8 20Z"
                />
              </svg>
            </a>
            <a
              class="icon-btn"
              href="https://buymeacoffee.com/0xhp10"
              rel="noopener noreferrer"
              aria-label="Donate"
              title="Donate"
              target="_blank"
            >
              <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path
                  d="M17 8h1a4 4 0 0 1 0 8h-1v2a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V8h12Zm1 6a2 2 0 0 0 0-4h-1v4h1Z"
                />
                <path d="M7 2h2v3H7V2Zm4 0h2v3h-2V2Z" />
              </svg>
            </a>
            <a
              class="icon-btn"
              href="https://github.com/hrvojepavlinovic/memoato-app"
              rel="noopener noreferrer"
              aria-label="GitHub"
              title="GitHub"
              target="_blank"
            >
              <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path
                  d="M12 .5a12 12 0 0 0-3.8 23.4c.6.1.8-.2.8-.5v-2c-3.3.7-4-1.4-4-1.4-.6-1.5-1.4-1.9-1.4-1.9-1.2-.8.1-.8.1-.8 1.3.1 2 .1 2.8 1.9 1.1 1.9 2.9 1.4 3.6 1.1.1-.8.4-1.4.7-1.7-2.7-.3-5.4-1.4-5.4-6.1 0-1.3.5-2.4 1.2-3.2-.1-.3-.5-1.6.1-3.3 0 0 1-.3 3.3 1.2a11.4 11.4 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.7.2 3 .1 3.3.8.8 1.2 1.9 1.2 3.2 0 4.7-2.7 5.8-5.4 6.1.4.3.8 1.1.8 2.2v3.3c0 .3.2.6.8.5A12 12 0 0 0 12 .5Z"
                />
              </svg>
            </a>
          </div>
        </div>
        <div>
          <div class="muted">Project</div>
          <ul class="list">
            <li><a href="/about">About</a></li>
            <li><a href="/open-source">Open source</a></li>
            <li><a href="/help">Help & FAQ</a></li>
            <li><a href="/contact">Contact</a></li>
          </ul>
        </div>
        <div>
          <div class="muted">Legal</div>
          <ul class="list">
            <li><a href="/privacy">Privacy policy</a></li>
            <li><a href="/terms">Terms</a></li>
          </ul>
          <div style="margin-top: 1rem" class="muted">
            Made by <a href="https://hills-lab.hr" rel="noopener noreferrer">HILLS Lab</a> Â·
            <a href="https://hrvoje.pavlinovic.com" rel="noopener noreferrer">Hrvoje</a>
          </div>
        </div>
      </div>
    </footer>

    <script is:inline>
      (function () {
        var allowed = { "memoato.com": true, "www.memoato.com": true };
        try {
          if (!allowed[window.location.hostname]) return;
        } catch {
          return;
        }

        var clientId = {JSON.stringify(databuddyClientId)};
        if (!clientId) return;

        function inject() {
          if (document.querySelector('script[src="https://cdn.databuddy.cc/databuddy.js"]')) return;
          var s = document.createElement("script");
          s.src = "https://cdn.databuddy.cc/databuddy.js";
          s.async = true;
          s.crossOrigin = "anonymous";
          s.dataset.clientId = clientId;
          s.dataset.trackAttributes = "true";
          s.dataset.trackOutgoingLinks = "true";
          s.dataset.trackInteractions = "true";
          document.head.appendChild(s);
        }

        function send() {
          try {
            if (window && window.databuddy && typeof window.databuddy.track === "function") {
              window.databuddy.track("landing_view", { path: window.location.pathname });
              return true;
            }
          } catch {}
          return false;
        }

        inject();
        if (send()) return;
        var attempts = 0;
        var t = setInterval(function () {
          attempts += 1;
          if (send() || attempts >= 30) clearInterval(t);
        }, 100);
      })();
    </script>
  </body>
</html>
