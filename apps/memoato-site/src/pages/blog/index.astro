---
import BaseLayout from "../../layouts/BaseLayout.astro";

const posts = (await Astro.glob("./*.md")).sort((a, b) => {
  const da = new Date(a.frontmatter.date ?? 0).getTime();
  const db = new Date(b.frontmatter.date ?? 0).getTime();
  return db - da;
});

function fmtDate(input: any): string | null {
  if (!input) return null;
  const d = new Date(input);
  if (Number.isNaN(d.getTime())) return null;
  return d.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "2-digit" });
}
---

<BaseLayout
  title="Blog Â· memoato"
  description="Memoato blog: product updates, features, and guides for minimal habit tracking."
  canonicalPath="/blog"
>
  <section class="section">
    <div class="container">
      <h1 class="page-title">Blog</h1>
      <div class="post-list">
        {posts.map((p) => {
          const title = p.frontmatter.title ?? p.url;
          const desc = p.frontmatter.description ?? "";
          const dateLabel = fmtDate(p.frontmatter.date);
          return (
            <a class="card post-card" href={p.url}>
              {dateLabel ? <div class="post-kicker">{dateLabel}</div> : null}
              <div class="post-title">{title}</div>
              {desc ? <div class="post-desc">{desc}</div> : null}
            </a>
          );
        })}
      </div>
    </div>
  </section>
</BaseLayout>
